!function(){function r(r){for(var e=0,t=0;t<r.length;t++){var n=r[t];switch(typeof n){case"number":e+=n;break;case"string":e+=n.length;break;case"object":}}return e}var e={exports:{}},t=e.exports;t.name="text",t.uri="http://sharejs.org/types/textv1",t.create=function(r){if(null!=r&&"string"!=typeof r)throw Error("Initial data must be a string");return r||""};var n=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},o=function(r){if(!n(r))throw Error("Op must be an array of components");for(var e=null,t=0;t<r.length;t++){var o=r[t];switch(typeof o){case"object":if(!("number"==typeof o.d&&o.d>0))throw Error("Object components must be deletes of size > 0");break;case"string":if(!(o.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(o>0))throw Error("Skip components must be >0");if("number"==typeof e)throw Error("Adjacent skip components should be combined")}e=o}if("number"==typeof e)throw Error("Op has a trailing skip")},s=function(r){return function(e){return e&&0!==e.d?0===r.length?r.push(e):typeof e==typeof r[r.length-1]?"object"==typeof e?r[r.length-1].d+=e.d:r[r.length-1]+=e:r.push(e):void 0}},a=function(r){var e=0,t=0,n=function(n,o){if(e===r.length)return-1===n?null:n;var s,a=r[e];return"number"==typeof a?-1===n||n>=a-t?(s=a-t,++e,t=0,s):(t+=n,n):"string"==typeof a?-1===n||"i"===o||a.length-t<=n?(s=a.slice(t),++e,t=0,s):(s=a.slice(t,t+n),t+=n,s):-1===n||"d"===o||a.d-t<=n?(s={d:a.d-t},++e,t=0,s):(t+=n,{d:n})},o=function(){return r[e]};return[n,o]},i=function(r){return"number"==typeof r?r:r.length||r.d},c=function(r){return r.length>0&&"number"==typeof r[r.length-1]&&r.pop(),r};t.normalize=function(r){for(var e=[],t=s(e),n=0;n<r.length;n++)t(r[n]);return c(e)},t.apply=function(r,e){if("string"!=typeof r)throw Error("Snapshot should be a string");o(e);for(var t=[],n=0;n<e.length;n++){var s=e[n];switch(typeof s){case"number":if(s>r.length)throw Error("The op is too long for this document");t.push(r.slice(0,s)),r=r.slice(s);break;case"string":t.push(s);break;case"object":r=r.slice(s.d)}}return t.join("")+r},t.transform=function(r,e,t){if("left"!=t&&"right"!=t)throw Error("side ("+t+") must be 'left' or 'right'");o(r),o(e);for(var n=[],f=s(n),u=a(r),l=u[0],h=u[1],b=0;b<e.length;b++){var p,g,m=e[b];switch(typeof m){case"number":for(p=m;p>0;)g=l(p,"i"),f(g),"string"!=typeof g&&(p-=i(g));break;case"string":"left"===t&&"string"==typeof h()&&f(l(-1)),f(m.length);break;case"object":for(p=m.d;p>0;)switch(g=l(p,"i"),typeof g){case"number":p-=g;break;case"string":f(g);break;case"object":p-=g.d}}}for(;m=l(-1);)f(m);return c(n)},t.compose=function(r,e){o(r),o(e);for(var t=[],n=s(t),f=a(r)[0],u=0;u<e.length;u++){var l,h,b=e[u];switch(typeof b){case"number":for(l=b;l>0;)h=f(l,"d"),n(h),"object"!=typeof h&&(l-=i(h));break;case"string":n(b);break;case"object":for(l=b.d;l>0;)switch(h=f(l,"d"),typeof h){case"number":n({d:h}),l-=h;break;case"string":l-=h.length;break;case"object":n(h)}}}for(;b=f(-1);)n(b);return c(t)};var f=function(r,e){for(var t=0,n=0;n<e.length;n++){var o=e[n];if(t>=r)break;switch(typeof o){case"number":if(t+o>=r)return r;t+=o;break;case"string":t+=o.length,r+=o.length;break;case"object":r-=Math.min(o.d,r-t)}}return r};t.transformSelection=function(r,e,t){var n=0;if(t){for(var o=0;o<e.length;o++){var s=e[o];switch(typeof s){case"number":n+=s;break;case"string":n+=s.length}}return n}return"number"==typeof r?f(r,e):[f(r[0],e),f(r[1],e)]},t.semanticInvert=function(e,n){if("string"!=typeof e)throw Error("Snapshot should be a string");o(n);var s=n.slice();n=n.slice();for(var a,i,f,u=n.length,l=0;u>l;l++){var h=n[l];switch(typeof h){case"number":break;case"string":n[l]={d:h.length};break;case"object":i=s.slice(0,l),a=r(i),f=t.apply(e,c(i)),n[l]=f.substring(a,a+h.d)}}return t.normalize(n)},t.transformCursor=t.transformSelection,t.selectionEq=function(r,e){return null!=r[0]&&r[0]===r[1]&&(r=r[0]),null!=e[0]&&e[0]===e[1]&&(e=e[0]),r===e||null!=r[0]&&null!=e[0]&&r[0]===e[0]&&r[1]==e[1]};var u=window.ottypes=window.ottypes||{},l=e.exports;u[l.name]=l,l.uri&&(u[l.uri]=l)}();